42060529f62f0b66e796e1b712d4a3a8
/**
 * Game: Blackjack
 * Classic casino table game where players aim to beat the dealer without busting.
 */

'use strict';

class Blackjack {
  constructor(options = {}) {
    this.name = 'Blackjack';
    this.type = 'CardGame';
    this.decksInShoe = options.decks || 6;
    this.minimumBet = options.minBet || 10;
    this.players = [];
    this.dealerHand = [];
    this.shoe = [];
    this.currentPlayerIndex = 0;
    this.isRoundActive = false;
  }
  initialize(playerCount = 1) {
    if (playerCount < 1) {
      throw new Error('Blackjack requires at least one player.');
    }
    this.players = Array.from({
      length: playerCount
    }).map(() => ({
      hand: [],
      bet: this.minimumBet,
      standing: false,
      bust: false,
      balance: 1000
    }));
    this.buildShoe();
    this.shuffleShoe();
    this.startRound();
    return {
      success: true,
      message: `${this.name} initialized with ${playerCount} player(s).`
    };
  }
  buildShoe() {
    const suits = ['hearts', 'diamonds', 'clubs', 'spades'];
    const ranks = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
    this.shoe = [];
    for (let deck = 0; deck < this.decksInShoe; deck++) {
      for (const suit of suits) {
        for (const rank of ranks) {
          this.shoe.push({
            rank,
            suit
          });
        }
      }
    }
  }
  shuffleShoe() {
    for (let i = this.shoe.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [this.shoe[i], this.shoe[j]] = [this.shoe[j], this.shoe[i]];
    }
  }
  drawCard() {
    if (this.shoe.length === 0) {
      this.buildShoe();
      this.shuffleShoe();
    }
    return this.shoe.pop();
  }
  startRound() {
    this.resetHands();
    this.dealInitialHands();
    this.isRoundActive = true;
    this.currentPlayerIndex = 0;
  }
  resetHands() {
    this.dealerHand = [];
    this.players.forEach(player => {
      player.hand = [];
      player.standing = false;
      player.bust = false;
    });
  }
  dealInitialHands() {
    for (let i = 0; i < 2; i++) {
      this.players.forEach(player => player.hand.push(this.drawCard()));
      this.dealerHand.push(this.drawCard());
    }
  }
  hit(playerIndex) {
    if (!this.isRoundActive || playerIndex !== this.currentPlayerIndex) {
      return {
        success: false,
        message: 'Not your turn to hit.'
      };
    }
    const player = this.players[playerIndex];
    player.hand.push(this.drawCard());
    if (this.calculateHandValue(player.hand) > 21) {
      player.bust = true;
      player.standing = true;
      this.advanceTurn();
      return {
        success: true,
        message: 'Player busts.'
      };
    }
    return {
      success: true,
      message: 'Card dealt.'
    };
  }
  stand(playerIndex) {
    if (!this.isRoundActive || playerIndex !== this.currentPlayerIndex) {
      return {
        success: false,
        message: 'Not your turn to stand.'
      };
    }
    this.players[playerIndex].standing = true;
    this.advanceTurn();
    return {
      success: true,
      message: 'Player stands.'
    };
  }
  advanceTurn() {
    const nextIndex = this.players.findIndex((player, idx) => idx > this.currentPlayerIndex && !player.standing);
    if (nextIndex !== -1) {
      this.currentPlayerIndex = nextIndex;
      return;
    }
    this.currentPlayerIndex = this.players.length; // indicates dealer turn
    this.resolveDealer();
  }
  resolveDealer() {
    while (this.calculateHandValue(this.dealerHand) < 17) {
      this.dealerHand.push(this.drawCard());
    }
    this.isRoundActive = false;
    return this.settleBets();
  }
  settleBets() {
    const dealerValue = this.calculateHandValue(this.dealerHand);
    const dealerBust = dealerValue > 21;
    return this.players.map(player => {
      const playerValue = this.calculateHandValue(player.hand);
      if (player.bust) {
        player.balance -= player.bet;
        return {
          outcome: 'lose',
          balance: player.balance
        };
      }
      if (dealerBust || playerValue > dealerValue) {
        player.balance += player.bet;
        return {
          outcome: 'win',
          balance: player.balance
        };
      }
      if (playerValue === dealerValue) {
        return {
          outcome: 'push',
          balance: player.balance
        };
      }
      player.balance -= player.bet;
      return {
        outcome: 'lose',
        balance: player.balance
      };
    });
  }
  calculateHandValue(hand) {
    let total = 0;
    let aceCount = 0;
    hand.forEach(card => {
      if (card.rank === 'A') {
        aceCount += 1;
        total += 11;
      } else if (['K', 'Q', 'J'].includes(card.rank) || card.rank === '10') {
        total += 10;
      } else {
        total += Number(card.rank);
      }
    });
    while (total > 21 && aceCount > 0) {
      total -= 10;
      aceCount -= 1;
    }
    return total;
  }
  getState() {
    return {
      players: this.players.map(player => ({
        hand: player.hand,
        standing: player.standing,
        bust: player.bust,
        balance: player.balance
      })),
      dealerHand: this.dealerHand,
      currentPlayerIndex: this.currentPlayerIndex,
      isRoundActive: this.isRoundActive
    };
  }
  reset() {
    this.players = [];
    this.dealerHand = [];
    this.shoe = [];
    this.currentPlayerIndex = 0;
    this.isRoundActive = false;
  }
}
module.exports = Blackjack;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCbGFja2phY2siLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJuYW1lIiwidHlwZSIsImRlY2tzSW5TaG9lIiwiZGVja3MiLCJtaW5pbXVtQmV0IiwibWluQmV0IiwicGxheWVycyIsImRlYWxlckhhbmQiLCJzaG9lIiwiY3VycmVudFBsYXllckluZGV4IiwiaXNSb3VuZEFjdGl2ZSIsImluaXRpYWxpemUiLCJwbGF5ZXJDb3VudCIsIkVycm9yIiwiQXJyYXkiLCJmcm9tIiwibGVuZ3RoIiwibWFwIiwiaGFuZCIsImJldCIsInN0YW5kaW5nIiwiYnVzdCIsImJhbGFuY2UiLCJidWlsZFNob2UiLCJzaHVmZmxlU2hvZSIsInN0YXJ0Um91bmQiLCJzdWNjZXNzIiwibWVzc2FnZSIsInN1aXRzIiwicmFua3MiLCJkZWNrIiwic3VpdCIsInJhbmsiLCJwdXNoIiwiaSIsImoiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJkcmF3Q2FyZCIsInBvcCIsInJlc2V0SGFuZHMiLCJkZWFsSW5pdGlhbEhhbmRzIiwiZm9yRWFjaCIsInBsYXllciIsImhpdCIsInBsYXllckluZGV4IiwiY2FsY3VsYXRlSGFuZFZhbHVlIiwiYWR2YW5jZVR1cm4iLCJzdGFuZCIsIm5leHRJbmRleCIsImZpbmRJbmRleCIsImlkeCIsInJlc29sdmVEZWFsZXIiLCJzZXR0bGVCZXRzIiwiZGVhbGVyVmFsdWUiLCJkZWFsZXJCdXN0IiwicGxheWVyVmFsdWUiLCJvdXRjb21lIiwidG90YWwiLCJhY2VDb3VudCIsImNhcmQiLCJpbmNsdWRlcyIsIk51bWJlciIsImdldFN0YXRlIiwicmVzZXQiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiQmxhY2tqYWNrLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogR2FtZTogQmxhY2tqYWNrXG4gKiBDbGFzc2ljIGNhc2lubyB0YWJsZSBnYW1lIHdoZXJlIHBsYXllcnMgYWltIHRvIGJlYXQgdGhlIGRlYWxlciB3aXRob3V0IGJ1c3RpbmcuXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG5jbGFzcyBCbGFja2phY2sge1xuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMgPSB7fSkge1xuICAgICAgICB0aGlzLm5hbWUgPSAnQmxhY2tqYWNrJztcbiAgICAgICAgdGhpcy50eXBlID0gJ0NhcmRHYW1lJztcbiAgICAgICAgdGhpcy5kZWNrc0luU2hvZSA9IG9wdGlvbnMuZGVja3MgfHwgNjtcbiAgICAgICAgdGhpcy5taW5pbXVtQmV0ID0gb3B0aW9ucy5taW5CZXQgfHwgMTA7XG4gICAgICAgIHRoaXMucGxheWVycyA9IFtdO1xuICAgICAgICB0aGlzLmRlYWxlckhhbmQgPSBbXTtcbiAgICAgICAgdGhpcy5zaG9lID0gW107XG4gICAgICAgIHRoaXMuY3VycmVudFBsYXllckluZGV4ID0gMDtcbiAgICAgICAgdGhpcy5pc1JvdW5kQWN0aXZlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgaW5pdGlhbGl6ZShwbGF5ZXJDb3VudCA9IDEpIHtcbiAgICAgICAgaWYgKHBsYXllckNvdW50IDwgMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdCbGFja2phY2sgcmVxdWlyZXMgYXQgbGVhc3Qgb25lIHBsYXllci4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucGxheWVycyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IHBsYXllckNvdW50IH0pLm1hcCgoKSA9PiAoe1xuICAgICAgICAgICAgaGFuZDogW10sXG4gICAgICAgICAgICBiZXQ6IHRoaXMubWluaW11bUJldCxcbiAgICAgICAgICAgIHN0YW5kaW5nOiBmYWxzZSxcbiAgICAgICAgICAgIGJ1c3Q6IGZhbHNlLFxuICAgICAgICAgICAgYmFsYW5jZTogMTAwMFxuICAgICAgICB9KSk7XG5cbiAgICAgICAgdGhpcy5idWlsZFNob2UoKTtcbiAgICAgICAgdGhpcy5zaHVmZmxlU2hvZSgpO1xuICAgICAgICB0aGlzLnN0YXJ0Um91bmQoKTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGAke3RoaXMubmFtZX0gaW5pdGlhbGl6ZWQgd2l0aCAke3BsYXllckNvdW50fSBwbGF5ZXIocykuYFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGJ1aWxkU2hvZSgpIHtcbiAgICAgICAgY29uc3Qgc3VpdHMgPSBbJ2hlYXJ0cycsICdkaWFtb25kcycsICdjbHVicycsICdzcGFkZXMnXTtcbiAgICAgICAgY29uc3QgcmFua3MgPSBbJ0EnLCAnMicsICczJywgJzQnLCAnNScsICc2JywgJzcnLCAnOCcsICc5JywgJzEwJywgJ0onLCAnUScsICdLJ107XG4gICAgICAgIHRoaXMuc2hvZSA9IFtdO1xuXG4gICAgICAgIGZvciAobGV0IGRlY2sgPSAwOyBkZWNrIDwgdGhpcy5kZWNrc0luU2hvZTsgZGVjaysrKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHN1aXQgb2Ygc3VpdHMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHJhbmsgb2YgcmFua3MpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG9lLnB1c2goeyByYW5rLCBzdWl0IH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNodWZmbGVTaG9lKCkge1xuICAgICAgICBmb3IgKGxldCBpID0gdGhpcy5zaG9lLmxlbmd0aCAtIDE7IGkgPiAwOyBpLS0pIHtcbiAgICAgICAgICAgIGNvbnN0IGogPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoaSArIDEpKTtcbiAgICAgICAgICAgIFt0aGlzLnNob2VbaV0sIHRoaXMuc2hvZVtqXV0gPSBbdGhpcy5zaG9lW2pdLCB0aGlzLnNob2VbaV1dO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZHJhd0NhcmQoKSB7XG4gICAgICAgIGlmICh0aGlzLnNob2UubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkU2hvZSgpO1xuICAgICAgICAgICAgdGhpcy5zaHVmZmxlU2hvZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnNob2UucG9wKCk7XG4gICAgfVxuXG4gICAgc3RhcnRSb3VuZCgpIHtcbiAgICAgICAgdGhpcy5yZXNldEhhbmRzKCk7XG4gICAgICAgIHRoaXMuZGVhbEluaXRpYWxIYW5kcygpO1xuICAgICAgICB0aGlzLmlzUm91bmRBY3RpdmUgPSB0cnVlO1xuICAgICAgICB0aGlzLmN1cnJlbnRQbGF5ZXJJbmRleCA9IDA7XG4gICAgfVxuXG4gICAgcmVzZXRIYW5kcygpIHtcbiAgICAgICAgdGhpcy5kZWFsZXJIYW5kID0gW107XG4gICAgICAgIHRoaXMucGxheWVycy5mb3JFYWNoKHBsYXllciA9PiB7XG4gICAgICAgICAgICBwbGF5ZXIuaGFuZCA9IFtdO1xuICAgICAgICAgICAgcGxheWVyLnN0YW5kaW5nID0gZmFsc2U7XG4gICAgICAgICAgICBwbGF5ZXIuYnVzdCA9IGZhbHNlO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBkZWFsSW5pdGlhbEhhbmRzKCkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDI7IGkrKykge1xuICAgICAgICAgICAgdGhpcy5wbGF5ZXJzLmZvckVhY2gocGxheWVyID0+IHBsYXllci5oYW5kLnB1c2godGhpcy5kcmF3Q2FyZCgpKSk7XG4gICAgICAgICAgICB0aGlzLmRlYWxlckhhbmQucHVzaCh0aGlzLmRyYXdDYXJkKCkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaGl0KHBsYXllckluZGV4KSB7XG4gICAgICAgIGlmICghdGhpcy5pc1JvdW5kQWN0aXZlIHx8IHBsYXllckluZGV4ICE9PSB0aGlzLmN1cnJlbnRQbGF5ZXJJbmRleCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIG1lc3NhZ2U6ICdOb3QgeW91ciB0dXJuIHRvIGhpdC4nIH07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwbGF5ZXIgPSB0aGlzLnBsYXllcnNbcGxheWVySW5kZXhdO1xuICAgICAgICBwbGF5ZXIuaGFuZC5wdXNoKHRoaXMuZHJhd0NhcmQoKSk7XG5cbiAgICAgICAgaWYgKHRoaXMuY2FsY3VsYXRlSGFuZFZhbHVlKHBsYXllci5oYW5kKSA+IDIxKSB7XG4gICAgICAgICAgICBwbGF5ZXIuYnVzdCA9IHRydWU7XG4gICAgICAgICAgICBwbGF5ZXIuc3RhbmRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5hZHZhbmNlVHVybigpO1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgbWVzc2FnZTogJ1BsYXllciBidXN0cy4nIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBtZXNzYWdlOiAnQ2FyZCBkZWFsdC4nIH07XG4gICAgfVxuXG4gICAgc3RhbmQocGxheWVySW5kZXgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzUm91bmRBY3RpdmUgfHwgcGxheWVySW5kZXggIT09IHRoaXMuY3VycmVudFBsYXllckluZGV4KSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogJ05vdCB5b3VyIHR1cm4gdG8gc3RhbmQuJyB9O1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5wbGF5ZXJzW3BsYXllckluZGV4XS5zdGFuZGluZyA9IHRydWU7XG4gICAgICAgIHRoaXMuYWR2YW5jZVR1cm4oKTtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgbWVzc2FnZTogJ1BsYXllciBzdGFuZHMuJyB9O1xuICAgIH1cblxuICAgIGFkdmFuY2VUdXJuKCkge1xuICAgICAgICBjb25zdCBuZXh0SW5kZXggPSB0aGlzLnBsYXllcnMuZmluZEluZGV4KChwbGF5ZXIsIGlkeCkgPT4gaWR4ID4gdGhpcy5jdXJyZW50UGxheWVySW5kZXggJiYgIXBsYXllci5zdGFuZGluZyk7XG4gICAgICAgIGlmIChuZXh0SW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRQbGF5ZXJJbmRleCA9IG5leHRJbmRleDtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY3VycmVudFBsYXllckluZGV4ID0gdGhpcy5wbGF5ZXJzLmxlbmd0aDsgLy8gaW5kaWNhdGVzIGRlYWxlciB0dXJuXG4gICAgICAgIHRoaXMucmVzb2x2ZURlYWxlcigpO1xuICAgIH1cblxuICAgIHJlc29sdmVEZWFsZXIoKSB7XG4gICAgICAgIHdoaWxlICh0aGlzLmNhbGN1bGF0ZUhhbmRWYWx1ZSh0aGlzLmRlYWxlckhhbmQpIDwgMTcpIHtcbiAgICAgICAgICAgIHRoaXMuZGVhbGVySGFuZC5wdXNoKHRoaXMuZHJhd0NhcmQoKSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmlzUm91bmRBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2V0dGxlQmV0cygpO1xuICAgIH1cblxuICAgIHNldHRsZUJldHMoKSB7XG4gICAgICAgIGNvbnN0IGRlYWxlclZhbHVlID0gdGhpcy5jYWxjdWxhdGVIYW5kVmFsdWUodGhpcy5kZWFsZXJIYW5kKTtcbiAgICAgICAgY29uc3QgZGVhbGVyQnVzdCA9IGRlYWxlclZhbHVlID4gMjE7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMucGxheWVycy5tYXAocGxheWVyID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHBsYXllclZhbHVlID0gdGhpcy5jYWxjdWxhdGVIYW5kVmFsdWUocGxheWVyLmhhbmQpO1xuXG4gICAgICAgICAgICBpZiAocGxheWVyLmJ1c3QpIHtcbiAgICAgICAgICAgICAgICBwbGF5ZXIuYmFsYW5jZSAtPSBwbGF5ZXIuYmV0O1xuICAgICAgICAgICAgICAgIHJldHVybiB7IG91dGNvbWU6ICdsb3NlJywgYmFsYW5jZTogcGxheWVyLmJhbGFuY2UgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGRlYWxlckJ1c3QgfHwgcGxheWVyVmFsdWUgPiBkZWFsZXJWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHBsYXllci5iYWxhbmNlICs9IHBsYXllci5iZXQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgb3V0Y29tZTogJ3dpbicsIGJhbGFuY2U6IHBsYXllci5iYWxhbmNlIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChwbGF5ZXJWYWx1ZSA9PT0gZGVhbGVyVmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBvdXRjb21lOiAncHVzaCcsIGJhbGFuY2U6IHBsYXllci5iYWxhbmNlIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHBsYXllci5iYWxhbmNlIC09IHBsYXllci5iZXQ7XG4gICAgICAgICAgICByZXR1cm4geyBvdXRjb21lOiAnbG9zZScsIGJhbGFuY2U6IHBsYXllci5iYWxhbmNlIH07XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGNhbGN1bGF0ZUhhbmRWYWx1ZShoYW5kKSB7XG4gICAgICAgIGxldCB0b3RhbCA9IDA7XG4gICAgICAgIGxldCBhY2VDb3VudCA9IDA7XG5cbiAgICAgICAgaGFuZC5mb3JFYWNoKGNhcmQgPT4ge1xuICAgICAgICAgICAgaWYgKGNhcmQucmFuayA9PT0gJ0EnKSB7XG4gICAgICAgICAgICAgICAgYWNlQ291bnQgKz0gMTtcbiAgICAgICAgICAgICAgICB0b3RhbCArPSAxMTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoWydLJywgJ1EnLCAnSiddLmluY2x1ZGVzKGNhcmQucmFuaykgfHwgY2FyZC5yYW5rID09PSAnMTAnKSB7XG4gICAgICAgICAgICAgICAgdG90YWwgKz0gMTA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRvdGFsICs9IE51bWJlcihjYXJkLnJhbmspO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICB3aGlsZSAodG90YWwgPiAyMSAmJiBhY2VDb3VudCA+IDApIHtcbiAgICAgICAgICAgIHRvdGFsIC09IDEwO1xuICAgICAgICAgICAgYWNlQ291bnQgLT0gMTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0b3RhbDtcbiAgICB9XG5cbiAgICBnZXRTdGF0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHBsYXllcnM6IHRoaXMucGxheWVycy5tYXAocGxheWVyID0+ICh7XG4gICAgICAgICAgICAgICAgaGFuZDogcGxheWVyLmhhbmQsXG4gICAgICAgICAgICAgICAgc3RhbmRpbmc6IHBsYXllci5zdGFuZGluZyxcbiAgICAgICAgICAgICAgICBidXN0OiBwbGF5ZXIuYnVzdCxcbiAgICAgICAgICAgICAgICBiYWxhbmNlOiBwbGF5ZXIuYmFsYW5jZVxuICAgICAgICAgICAgfSkpLFxuICAgICAgICAgICAgZGVhbGVySGFuZDogdGhpcy5kZWFsZXJIYW5kLFxuICAgICAgICAgICAgY3VycmVudFBsYXllckluZGV4OiB0aGlzLmN1cnJlbnRQbGF5ZXJJbmRleCxcbiAgICAgICAgICAgIGlzUm91bmRBY3RpdmU6IHRoaXMuaXNSb3VuZEFjdGl2ZVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHJlc2V0KCkge1xuICAgICAgICB0aGlzLnBsYXllcnMgPSBbXTtcbiAgICAgICAgdGhpcy5kZWFsZXJIYW5kID0gW107XG4gICAgICAgIHRoaXMuc2hvZSA9IFtdO1xuICAgICAgICB0aGlzLmN1cnJlbnRQbGF5ZXJJbmRleCA9IDA7XG4gICAgICAgIHRoaXMuaXNSb3VuZEFjdGl2ZSA9IGZhbHNlO1xuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBCbGFja2phY2s7Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxZQUFZOztBQUVaLE1BQU1BLFNBQVMsQ0FBQztFQUNaQyxXQUFXQSxDQUFDQyxPQUFPLEdBQUcsQ0FBQyxDQUFDLEVBQUU7SUFDdEIsSUFBSSxDQUFDQyxJQUFJLEdBQUcsV0FBVztJQUN2QixJQUFJ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
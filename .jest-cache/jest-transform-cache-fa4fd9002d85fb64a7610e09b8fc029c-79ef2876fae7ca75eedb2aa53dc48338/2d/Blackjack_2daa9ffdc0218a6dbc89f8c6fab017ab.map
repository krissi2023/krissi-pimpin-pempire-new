{"version":3,"names":["Blackjack","constructor","options","name","type","decksInShoe","decks","minimumBet","minBet","players","dealerHand","shoe","currentPlayerIndex","isRoundActive","initialize","playerCount","Error","Array","from","length","map","hand","bet","standing","bust","balance","buildShoe","shuffleShoe","startRound","success","message","suits","ranks","deck","suit","rank","push","i","j","Math","floor","random","drawCard","pop","resetHands","dealInitialHands","forEach","player","hit","playerIndex","calculateHandValue","advanceTurn","stand","nextIndex","findIndex","idx","resolveDealer","settleBets","dealerValue","dealerBust","playerValue","outcome","total","aceCount","card","includes","Number","getState","reset","module","exports"],"sources":["Blackjack.js"],"sourcesContent":["/**\n * Game: Blackjack\n * Classic casino table game where players aim to beat the dealer without busting.\n */\n\n'use strict';\n\nclass Blackjack {\n    constructor(options = {}) {\n        this.name = 'Blackjack';\n        this.type = 'CardGame';\n        this.decksInShoe = options.decks || 6;\n        this.minimumBet = options.minBet || 10;\n        this.players = [];\n        this.dealerHand = [];\n        this.shoe = [];\n        this.currentPlayerIndex = 0;\n        this.isRoundActive = false;\n    }\n\n    initialize(playerCount = 1) {\n        if (playerCount < 1) {\n            throw new Error('Blackjack requires at least one player.');\n        }\n\n        this.players = Array.from({ length: playerCount }).map(() => ({\n            hand: [],\n            bet: this.minimumBet,\n            standing: false,\n            bust: false,\n            balance: 1000\n        }));\n\n        this.buildShoe();\n        this.shuffleShoe();\n        this.startRound();\n\n        return {\n            success: true,\n            message: `${this.name} initialized with ${playerCount} player(s).`\n        };\n    }\n\n    buildShoe() {\n        const suits = ['hearts', 'diamonds', 'clubs', 'spades'];\n        const ranks = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];\n        this.shoe = [];\n\n        for (let deck = 0; deck < this.decksInShoe; deck++) {\n            for (const suit of suits) {\n                for (const rank of ranks) {\n                    this.shoe.push({ rank, suit });\n                }\n            }\n        }\n    }\n\n    shuffleShoe() {\n        for (let i = this.shoe.length - 1; i > 0; i--) {\n            const j = Math.floor(Math.random() * (i + 1));\n            [this.shoe[i], this.shoe[j]] = [this.shoe[j], this.shoe[i]];\n        }\n    }\n\n    drawCard() {\n        if (this.shoe.length === 0) {\n            this.buildShoe();\n            this.shuffleShoe();\n        }\n        return this.shoe.pop();\n    }\n\n    startRound() {\n        this.resetHands();\n        this.dealInitialHands();\n        this.isRoundActive = true;\n        this.currentPlayerIndex = 0;\n    }\n\n    resetHands() {\n        this.dealerHand = [];\n        this.players.forEach(player => {\n            player.hand = [];\n            player.standing = false;\n            player.bust = false;\n        });\n    }\n\n    dealInitialHands() {\n        for (let i = 0; i < 2; i++) {\n            this.players.forEach(player => player.hand.push(this.drawCard()));\n            this.dealerHand.push(this.drawCard());\n        }\n    }\n\n    hit(playerIndex) {\n        if (!this.isRoundActive || playerIndex !== this.currentPlayerIndex) {\n            return { success: false, message: 'Not your turn to hit.' };\n        }\n\n        const player = this.players[playerIndex];\n        player.hand.push(this.drawCard());\n\n        if (this.calculateHandValue(player.hand) > 21) {\n            player.bust = true;\n            player.standing = true;\n            this.advanceTurn();\n            return { success: true, message: 'Player busts.' };\n        }\n\n        return { success: true, message: 'Card dealt.' };\n    }\n\n    stand(playerIndex) {\n        if (!this.isRoundActive || playerIndex !== this.currentPlayerIndex) {\n            return { success: false, message: 'Not your turn to stand.' };\n        }\n\n        this.players[playerIndex].standing = true;\n        this.advanceTurn();\n        return { success: true, message: 'Player stands.' };\n    }\n\n    advanceTurn() {\n        const nextIndex = this.players.findIndex((player, idx) => idx > this.currentPlayerIndex && !player.standing);\n        if (nextIndex !== -1) {\n            this.currentPlayerIndex = nextIndex;\n            return;\n        }\n\n        this.currentPlayerIndex = this.players.length; // indicates dealer turn\n        this.resolveDealer();\n    }\n\n    resolveDealer() {\n        while (this.calculateHandValue(this.dealerHand) < 17) {\n            this.dealerHand.push(this.drawCard());\n        }\n\n        this.isRoundActive = false;\n        return this.settleBets();\n    }\n\n    settleBets() {\n        const dealerValue = this.calculateHandValue(this.dealerHand);\n        const dealerBust = dealerValue > 21;\n\n        return this.players.map(player => {\n            const playerValue = this.calculateHandValue(player.hand);\n\n            if (player.bust) {\n                player.balance -= player.bet;\n                return { outcome: 'lose', balance: player.balance };\n            }\n\n            if (dealerBust || playerValue > dealerValue) {\n                player.balance += player.bet;\n                return { outcome: 'win', balance: player.balance };\n            }\n\n            if (playerValue === dealerValue) {\n                return { outcome: 'push', balance: player.balance };\n            }\n\n            player.balance -= player.bet;\n            return { outcome: 'lose', balance: player.balance };\n        });\n    }\n\n    calculateHandValue(hand) {\n        let total = 0;\n        let aceCount = 0;\n\n        hand.forEach(card => {\n            if (card.rank === 'A') {\n                aceCount += 1;\n                total += 11;\n            } else if (['K', 'Q', 'J'].includes(card.rank) || card.rank === '10') {\n                total += 10;\n            } else {\n                total += Number(card.rank);\n            }\n        });\n\n        while (total > 21 && aceCount > 0) {\n            total -= 10;\n            aceCount -= 1;\n        }\n\n        return total;\n    }\n\n    getState() {\n        return {\n            players: this.players.map(player => ({\n                hand: player.hand,\n                standing: player.standing,\n                bust: player.bust,\n                balance: player.balance\n            })),\n            dealerHand: this.dealerHand,\n            currentPlayerIndex: this.currentPlayerIndex,\n            isRoundActive: this.isRoundActive\n        };\n    }\n\n    reset() {\n        this.players = [];\n        this.dealerHand = [];\n        this.shoe = [];\n        this.currentPlayerIndex = 0;\n        this.isRoundActive = false;\n    }\n}\n\nmodule.exports = Blackjack;"],"mappings":"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","ignoreList":[]}
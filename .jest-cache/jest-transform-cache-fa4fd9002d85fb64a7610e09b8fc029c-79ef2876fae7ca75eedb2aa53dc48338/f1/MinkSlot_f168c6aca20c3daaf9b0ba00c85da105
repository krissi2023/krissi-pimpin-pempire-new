d50c414394dc8f84e75126efb5fecb7f
'use strict';

/**
 * Game: Mink Slot
 * Fashion-forward slot experience themed around mink coats and luxury prizes.
 */
class MinkSlot {
  constructor(options = {}) {
    this.spinCost = this.normalizeNumber(options.spinCost, 6);
    this.credits = this.normalizeNumber(options.startingCredits, 120);
    this.resetState();
  }
  initialize(options = {}) {
    if (typeof options.startingCredits === 'number') {
      this.credits = this.normalizeNumber(options.startingCredits, this.credits);
    }
    if (typeof options.spinCost === 'number') {
      this.spinCost = this.normalizeNumber(options.spinCost, this.spinCost);
    }
    this.resetState();
    return this.getState();
  }
  generateReels() {
    const symbols = ['MINK', 'FUR_COLLAR', 'GOLD_RING', 'PERFUME', 'HAT_PIN', 'BAR'];
    const reels = [];
    for (let i = 0; i < 3; i += 1) {
      reels.push(symbols.slice());
    }
    return reels;
  }
  startGame() {
    this.resetState();
    return this.getState();
  }
  spin() {
    if (this.isSpinning || this.credits < this.spinCost) {
      return {
        success: false,
        message: 'Cannot spin at this moment.'
      };
    }
    this.isSpinning = true;
    this.credits -= this.spinCost;
    this.lastSpinResult = this.reels.map(symbols => symbols[Math.floor(Math.random() * symbols.length)]);
    this.evaluateSpin();
    this.isSpinning = false;
    return {
      success: true,
      result: this.lastSpinResult.slice(),
      winAmount: this.winAmount,
      credits: this.credits,
      state: this.getState()
    };
  }
  evaluateSpin() {
    if (this.lastSpinResult.length === 0) {
      return;
    }
    if (this.lastSpinResult.every(symbol => symbol === 'MINK')) {
      this.winAmount = 450;
      this.credits += this.winAmount;
      return;
    }
    if (this.lastSpinResult.filter(symbol => symbol === 'FUR_COLLAR').length === 2) {
      this.winAmount = 60;
      this.credits += this.winAmount;
      return;
    }
    this.winAmount = 0;
  }
  getState() {
    return {
      credits: this.credits,
      lastSpinResult: this.lastSpinResult.slice(),
      winAmount: this.winAmount,
      spinCost: this.spinCost
    };
  }
  resetState() {
    this.reels = this.generateReels();
    this.isSpinning = false;
    this.lastSpinResult = [];
    this.winAmount = 0;
  }
  normalizeNumber(value, fallback) {
    if (typeof value !== 'number' || Number.isNaN(value) || value <= 0) {
      return fallback;
    }
    return Math.floor(value);
  }
}
module.exports = MinkSlot;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJNaW5rU2xvdCIsImNvbnN0cnVjdG9yIiwib3B0aW9ucyIsInNwaW5Db3N0Iiwibm9ybWFsaXplTnVtYmVyIiwiY3JlZGl0cyIsInN0YXJ0aW5nQ3JlZGl0cyIsInJlc2V0U3RhdGUiLCJpbml0aWFsaXplIiwiZ2V0U3RhdGUiLCJnZW5lcmF0ZVJlZWxzIiwic3ltYm9scyIsInJlZWxzIiwiaSIsInB1c2giLCJzbGljZSIsInN0YXJ0R2FtZSIsInNwaW4iLCJpc1NwaW5uaW5nIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJsYXN0U3BpblJlc3VsdCIsIm1hcCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImxlbmd0aCIsImV2YWx1YXRlU3BpbiIsInJlc3VsdCIsIndpbkFtb3VudCIsInN0YXRlIiwiZXZlcnkiLCJzeW1ib2wiLCJmaWx0ZXIiLCJ2YWx1ZSIsImZhbGxiYWNrIiwiTnVtYmVyIiwiaXNOYU4iLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiTWlua1Nsb3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIEdhbWU6IE1pbmsgU2xvdFxuICogRmFzaGlvbi1mb3J3YXJkIHNsb3QgZXhwZXJpZW5jZSB0aGVtZWQgYXJvdW5kIG1pbmsgY29hdHMgYW5kIGx1eHVyeSBwcml6ZXMuXG4gKi9cblxuY2xhc3MgTWlua1Nsb3Qge1xuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMgPSB7fSkge1xuICAgICAgICB0aGlzLnNwaW5Db3N0ID0gdGhpcy5ub3JtYWxpemVOdW1iZXIob3B0aW9ucy5zcGluQ29zdCwgNik7XG4gICAgICAgIHRoaXMuY3JlZGl0cyA9IHRoaXMubm9ybWFsaXplTnVtYmVyKG9wdGlvbnMuc3RhcnRpbmdDcmVkaXRzLCAxMjApO1xuICAgICAgICB0aGlzLnJlc2V0U3RhdGUoKTtcbiAgICB9XG5cbiAgICBpbml0aWFsaXplKG9wdGlvbnMgPSB7fSkge1xuICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnMuc3RhcnRpbmdDcmVkaXRzID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgdGhpcy5jcmVkaXRzID0gdGhpcy5ub3JtYWxpemVOdW1iZXIob3B0aW9ucy5zdGFydGluZ0NyZWRpdHMsIHRoaXMuY3JlZGl0cyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLnNwaW5Db3N0ID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgdGhpcy5zcGluQ29zdCA9IHRoaXMubm9ybWFsaXplTnVtYmVyKG9wdGlvbnMuc3BpbkNvc3QsIHRoaXMuc3BpbkNvc3QpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVzZXRTdGF0ZSgpO1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRTdGF0ZSgpO1xuICAgIH1cblxuICAgIGdlbmVyYXRlUmVlbHMoKSB7XG4gICAgICAgIGNvbnN0IHN5bWJvbHMgPSBbJ01JTksnLCAnRlVSX0NPTExBUicsICdHT0xEX1JJTkcnLCAnUEVSRlVNRScsICdIQVRfUElOJywgJ0JBUiddO1xuICAgICAgICBjb25zdCByZWVscyA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDM7IGkgKz0gMSkge1xuICAgICAgICAgICAgcmVlbHMucHVzaChzeW1ib2xzLnNsaWNlKCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZWVscztcbiAgICB9XG5cbiAgICBzdGFydEdhbWUoKSB7XG4gICAgICAgIHRoaXMucmVzZXRTdGF0ZSgpO1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRTdGF0ZSgpO1xuICAgIH1cblxuICAgIHNwaW4oKSB7XG4gICAgICAgIGlmICh0aGlzLmlzU3Bpbm5pbmcgfHwgdGhpcy5jcmVkaXRzIDwgdGhpcy5zcGluQ29zdCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIG1lc3NhZ2U6ICdDYW5ub3Qgc3BpbiBhdCB0aGlzIG1vbWVudC4nIH07XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmlzU3Bpbm5pbmcgPSB0cnVlO1xuICAgICAgICB0aGlzLmNyZWRpdHMgLT0gdGhpcy5zcGluQ29zdDtcbiAgICAgICAgdGhpcy5sYXN0U3BpblJlc3VsdCA9IHRoaXMucmVlbHMubWFwKChzeW1ib2xzKSA9PiBzeW1ib2xzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHN5bWJvbHMubGVuZ3RoKV0pO1xuICAgICAgICB0aGlzLmV2YWx1YXRlU3BpbigpO1xuICAgICAgICB0aGlzLmlzU3Bpbm5pbmcgPSBmYWxzZTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIHJlc3VsdDogdGhpcy5sYXN0U3BpblJlc3VsdC5zbGljZSgpLFxuICAgICAgICAgICAgd2luQW1vdW50OiB0aGlzLndpbkFtb3VudCxcbiAgICAgICAgICAgIGNyZWRpdHM6IHRoaXMuY3JlZGl0cyxcbiAgICAgICAgICAgIHN0YXRlOiB0aGlzLmdldFN0YXRlKClcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBldmFsdWF0ZVNwaW4oKSB7XG4gICAgICAgIGlmICh0aGlzLmxhc3RTcGluUmVzdWx0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMubGFzdFNwaW5SZXN1bHQuZXZlcnkoKHN5bWJvbCkgPT4gc3ltYm9sID09PSAnTUlOSycpKSB7XG4gICAgICAgICAgICB0aGlzLndpbkFtb3VudCA9IDQ1MDtcbiAgICAgICAgICAgIHRoaXMuY3JlZGl0cyArPSB0aGlzLndpbkFtb3VudDtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmxhc3RTcGluUmVzdWx0LmZpbHRlcigoc3ltYm9sKSA9PiBzeW1ib2wgPT09ICdGVVJfQ09MTEFSJykubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICB0aGlzLndpbkFtb3VudCA9IDYwO1xuICAgICAgICAgICAgdGhpcy5jcmVkaXRzICs9IHRoaXMud2luQW1vdW50O1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy53aW5BbW91bnQgPSAwO1xuICAgIH1cblxuICAgIGdldFN0YXRlKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY3JlZGl0czogdGhpcy5jcmVkaXRzLFxuICAgICAgICAgICAgbGFzdFNwaW5SZXN1bHQ6IHRoaXMubGFzdFNwaW5SZXN1bHQuc2xpY2UoKSxcbiAgICAgICAgICAgIHdpbkFtb3VudDogdGhpcy53aW5BbW91bnQsXG4gICAgICAgICAgICBzcGluQ29zdDogdGhpcy5zcGluQ29zdFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHJlc2V0U3RhdGUoKSB7XG4gICAgICAgIHRoaXMucmVlbHMgPSB0aGlzLmdlbmVyYXRlUmVlbHMoKTtcbiAgICAgICAgdGhpcy5pc1NwaW5uaW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMubGFzdFNwaW5SZXN1bHQgPSBbXTtcbiAgICAgICAgdGhpcy53aW5BbW91bnQgPSAwO1xuICAgIH1cblxuICAgIG5vcm1hbGl6ZU51bWJlcih2YWx1ZSwgZmFsbGJhY2spIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ251bWJlcicgfHwgTnVtYmVyLmlzTmFOKHZhbHVlKSB8fCB2YWx1ZSA8PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsbGJhY2s7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IodmFsdWUpO1xuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBNaW5rU2xvdDtcbiJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWTs7QUFFWjtBQUNBO0FBQ0E7QUFDQTtBQUVBLE1BQU1BLFFBQVEsQ0FBQztFQUNYQyxXQUFXQSxDQUFDQyxPQUFPLEdBQUcsQ0FBQyxDQUFDLEVBQUU7SUFDdEIsSUFBSSxDQUFDQyxRQUFRLEdBQUcsSUFBSSxDQUFDQyxlQUFlLENBQUNGLE9BQU8sQ0FB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
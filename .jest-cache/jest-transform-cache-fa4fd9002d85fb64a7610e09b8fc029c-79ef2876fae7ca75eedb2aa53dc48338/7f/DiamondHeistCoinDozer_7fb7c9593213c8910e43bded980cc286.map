{"version":3,"names":["DiamondHeistCoinDozer","constructor","options","width","height","dropThreshold","coinValue","diamondBaseValue","diamondValue","coinTable","diamondTable","dropHistory","jackpot","score","isRunning","gameInterval","tickRateMs","startGame","generateCoins","generateDiamonds","startLoop","getState","stopGame","stopLoop","count","coins","i","push","id","Date","now","x","Math","random","y","value","gems","pushCoin","lane","success","reason","laneWidth","constrainedLane","max","min","xPosition","newCoin","toString","slice","animateCoinPush","simulateStep","coin","state","advanceCoins","drops","collectDrops","diamondsCollected","length","forEach","gem","animateDiamondCatch","triggerHeistAnimation","table","deltaY","item","coinsCollected","filter","setInterval","clearInterval","endGame","finalState","showJackpotWin","map","diamonds","dispose","diamondsRemaining","module","exports"],"sources":["DiamondHeistCoinDozer.js"],"sourcesContent":["/**\n * Game: Diamond Heist Coin Dozer\n * Push coins, scoop diamonds, trigger heists for big rewards!\n * Features: Physics for coins, diamond prizes, heist triggers, jackpot, real-time updates, animations.\n */\n\n'use strict';\n\nclass DiamondHeistCoinDozer {\n    constructor(options = {}) {\n        this.width = options.width || 100;\n        this.height = options.height || 100;\n        this.dropThreshold = options.dropThreshold || 95;\n        this.coinValue = options.coinValue || 1;\n        this.diamondBaseValue = options.diamondValue || 100;\n\n        this.coinTable = [];\n        this.diamondTable = [];\n        this.dropHistory = [];\n        this.jackpot = false;\n        this.score = 0;\n        this.isRunning = false;\n        this.gameInterval = null;\n        this.tickRateMs = options.tickRateMs || 80;\n    }\n\n    startGame() {\n        this.coinTable = this.generateCoins(50);\n        this.diamondTable = this.generateDiamonds(5);\n        this.dropHistory = [];\n        this.jackpot = false;\n        this.score = 0;\n        this.isRunning = true;\n        this.startLoop();\n        return this.getState();\n    }\n\n    stopGame() {\n        this.isRunning = false;\n        this.stopLoop();\n        return this.getState();\n    }\n\n    generateCoins(count) {\n        const coins = [];\n        for (let i = 0; i < count; i += 1) {\n            coins.push({\n                id: `coin-${Date.now()}-${i}`,\n                x: Math.random() * this.width,\n                y: Math.random() * (this.height * 0.8),\n                value: this.coinValue\n            });\n        }\n        return coins;\n    }\n\n    generateDiamonds(count) {\n        const gems = [];\n        for (let i = 0; i < count; i += 1) {\n            gems.push({\n                id: `diamond-${Date.now()}-${i}`,\n                x: Math.random() * this.width,\n                y: Math.random() * (this.height * 0.7),\n                value: this.diamondBaseValue\n            });\n        }\n        return gems;\n    }\n\n    pushCoin(lane = 0) {\n        if (!this.isRunning) {\n            return { success: false, reason: 'Game is not running.' };\n        }\n\n        const laneWidth = this.width / 5;\n        const constrainedLane = Math.max(0, Math.min(4, lane));\n        const xPosition = constrainedLane * laneWidth + laneWidth / 2;\n        const newCoin = {\n            id: `coin-${Date.now()}-${Math.random().toString(36).slice(2, 6)}`,\n            x: xPosition,\n            y: 0,\n            value: this.coinValue\n        };\n\n        this.coinTable.push(newCoin);\n        this.animateCoinPush(newCoin);\n        this.simulateStep();\n        return {\n            success: true,\n            coin: newCoin,\n            state: this.getState()\n        };\n    }\n\n    simulateStep() {\n        this.advanceCoins(this.coinTable, 2.5);\n        this.advanceCoins(this.diamondTable, 1.2);\n        const drops = this.collectDrops();\n        if (drops.diamondsCollected.length > 0) {\n            this.jackpot = true;\n            drops.diamondsCollected.forEach((gem) => this.animateDiamondCatch(gem));\n        }\n        if (this.jackpot && drops.diamondsCollected.length > 0) {\n            this.triggerHeistAnimation();\n        }\n        this.dropHistory.push(drops);\n        return drops;\n    }\n\n    advanceCoins(table, deltaY) {\n        for (const item of table) {\n            item.y += deltaY;\n            if (item.y > this.height) {\n                item.y = this.height;\n            }\n        }\n    }\n\n    collectDrops() {\n        const coinsCollected = [];\n        const diamondsCollected = [];\n\n        this.coinTable = this.coinTable.filter((coin) => {\n            if (coin.y >= this.dropThreshold) {\n                coinsCollected.push(coin);\n                this.score += coin.value;\n                return false;\n            }\n            return true;\n        });\n\n        this.diamondTable = this.diamondTable.filter((gem) => {\n            if (gem.y >= this.dropThreshold) {\n                diamondsCollected.push(gem);\n                this.score += gem.value;\n                return false;\n            }\n            return true;\n        });\n\n        return {\n            coinsCollected,\n            diamondsCollected\n        };\n    }\n\n    startLoop() {\n        this.stopLoop();\n        this.gameInterval = setInterval(() => {\n            if (!this.isRunning) {\n                this.stopLoop();\n                return;\n            }\n\n            this.simulateStep();\n        }, this.tickRateMs);\n    }\n\n    stopLoop() {\n        if (this.gameInterval) {\n            clearInterval(this.gameInterval);\n            this.gameInterval = null;\n        }\n    }\n\n    endGame() {\n        const finalState = this.stopGame();\n        if (this.jackpot) {\n            this.showJackpotWin();\n        }\n        return finalState;\n    }\n\n    getState() {\n        return {\n            coins: this.coinTable.map((coin) => ({ ...coin })),\n            diamonds: this.diamondTable.map((gem) => ({ ...gem })),\n            score: this.score,\n            jackpot: this.jackpot,\n            isRunning: this.isRunning,\n            drops: this.dropHistory.slice(-5)\n        };\n    }\n\n    dispose() {\n        this.stopLoop();\n    }\n\n    // ==== Animation hooks ==== \n    animateCoinPush(coin) {\n        return coin;\n    }\n\n    animateDiamondCatch(gem) {\n        return gem;\n    }\n\n    triggerHeistAnimation() {\n        this.jackpot = false;\n    }\n\n    showJackpotWin() {\n        return {\n            score: this.score,\n            diamondsRemaining: this.diamondTable.length\n        };\n    }\n}\n\nmodule.exports = DiamondHeistCoinDozer;"],"mappings":"AAAA;AACA;AACA;AACA;AACA;;AAEA,YAAY;;AAEZ,MAAMA,qBAAqB,CAAC;EACxBC,WAAWA,CAACC,OAAO,GAAG,CAAC,CAAC,EAAE;IACtB,IAAI,CAACC,KAAK,GAAGD,OAAO,CAACC,KAAK,IAAI,GAAG;IACjC,IAAI,CAACC,MAAM,GAAGF,OAAO,CAACE,MAAM,IAAI,GAAG;IACnC,IAAI,CAACC,aAAa,GAAGH,OAAO,CAACG,aAAa,IAAI,EAAE;IAChD,IAAI,CAACC,SAAS,GAAGJ,OAAO,CAACI,SAAS,IAAI,CAAC;IACvC,IAAI,CAACC,gBAAgB,GAAGL,OAAO,CAACM,YAAY,IAAI,GAAG;IAEnD,IAAI,CAACC,SAAS,GAAG,EAAE;IACnB,IAAI,CAACC,YAAY,GAAG,EAAE;IACtB,IAAI,CAACC,WAAW,GAAG,EAAE;IACrB,IAAI,CAACC,OAAO,GAAG,KAAK;IACpB,IAAI,CAACC,KAAK,GAAG,CAAC;IACd,IAAI,CAACC,SAAS,GAAG,KAAK;IACtB,IAAI,CAACC,YAAY,GAAG,IAAI;IACxB,IAAI,CAACC,UAAU,GAAGd,OAAO,CAACc,UAAU,IAAI,EAAE;EAC9C;EAEAC,SAASA,CAAA,EAAG;IACR,IAAI,CAACR,SAAS,GAAG,IAAI,CAACS,aAAa,CAAC,EAAE,CAAC;IACvC,IAAI,CAACR,YAAY,GAAG,IAAI,CAACS,gBAAgB,CAAC,CAAC,CAAC;IAC5C,IAAI,CAACR,WAAW,GAAG,EAAE;IACrB,IAAI,CAACC,OAAO,GAAG,KAAK;IACpB,IAAI,CAACC,KAAK,GAAG,CAAC;IACd,IAAI,CAACC,SAAS,GAAG,IAAI;IACrB,IAAI,CAACM,SAAS,CAAC,CAAC;IAChB,OAAO,IAAI,CAACC,QAAQ,CAAC,CAAC;EAC1B;EAEAC,QAAQA,CAAA,EAAG;IACP,IAAI,CAACR,SAAS,GAAG,KAAK;IACtB,IAAI,CAACS,QAAQ,CAAC,CAAC;IACf,OAAO,IAAI,CAACF,QAAQ,CAAC,CAAC;EAC1B;EAEAH,aAAaA,CAACM,KAAK,EAAE;IACjB,MAAMC,KAAK,GAAG,EAAE;IAChB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGF,KAAK,EAAEE,CAAC,IAAI,CAAC,EAAE;MAC/BD,KAAK,CAACE,IAAI,CAAC;QACPC,EAAE,EAAE,QAAQC,IAAI,CAACC,GAAG,CAAC,CAAC,IAAIJ,CAAC,EAAE;QAC7BK,CAAC,EAAEC,IAAI,CAACC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC9B,KAAK;QAC7B+B,CAAC,EAAEF,IAAI,CAACC,MAAM,CAAC,CAAC,IAAI,IAAI,CAAC7B,MAAM,GAAG,GAAG,CAAC;QACtC+B,KAAK,EAAE,IAAI,CAAC7B;MAChB,CAAC,CAAC;IACN;IACA,OAAOmB,KAAK;EAChB;EAEAN,gBAAgBA,CAACK,KAAK,EAAE;IACpB,MAAMY,IAAI,GAAG,EAAE;IACf,KAAK,IAAIV,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGF,KAAK,EAAEE,CAAC,IAAI,CAAC,EAAE;MAC/BU,IAAI,CAACT,IAAI,CAAC;QACNC,EAAE,EAAE,WAAWC,IAAI,CAACC,GAAG,CAAC,CAAC,IAAIJ,CAAC,EAAE;QAChCK,CAAC,EAAEC,IAAI,CAACC,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC9B,KAAK;QAC7B+B,CAAC,EAAEF,IAAI,CAACC,MAAM,CAAC,CAAC,IAAI,IAAI,CAAC7B,MAAM,GAAG,GAAG,CAAC;QACtC+B,KAAK,EAAE,IAAI,CAAC5B;MAChB,CAAC,CAAC;IACN;IACA,OAAO6B,IAAI;EACf;EAEAC,QAAQA,CAACC,IAAI,GAAG,CAAC,EAAE;IACf,IAAI,CAAC,IAAI,CAACxB,SAAS,EAAE;MACjB,OAAO;QAAEyB,OAAO,EAAE,KAAK;QAAEC,MAAM,EAAE;MAAuB,CAAC;IAC7D;IAEA,MAAMC,SAAS,GAAG,IAAI,CAACtC,KAAK,GAAG,CAAC;IAChC,MAAMuC,eAAe,GAAGV,IAAI,CAACW,GAAG,CAAC,CAAC,EAAEX,IAAI,CAACY,GAAG,CAAC,CAAC,EAAEN,IAAI,CAAC,CAAC;IACtD,MAAMO,SAAS,GAAGH,eAAe,GAAGD,SAAS,GAAGA,SAAS,GAAG,CAAC;IAC7D,MAAMK,OAAO,GAAG;MACZlB,EAAE,EAAE,QAAQC,IAAI,CAACC,GAAG,CAAC,CAAC,IAAIE,IAAI,CAACC,MAAM,CAAC,CAAC,CAACc,QAAQ,CAAC,EAAE,CAAC,CAACC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;MAClEjB,CAAC,EAAEc,SAAS;MACZX,CAAC,EAAE,CAAC;MACJC,KAAK,EAAE,IAAI,CAAC7B;IAChB,CAAC;IAED,IAAI,CAACG,SAAS,CAACkB,IAAI,CAACmB,OAAO,CAAC;IAC5B,IAAI,CAACG,eAAe,CAACH,OAAO,CAAC;IAC7B,IAAI,CAACI,YAAY,CAAC,CAAC;IACnB,OAAO;MACHX,OAAO,EAAE,IAAI;MACbY,IAAI,EAAEL,OAAO;MACbM,KAAK,EAAE,IAAI,CAAC/B,QAAQ,CAAC;IACzB,CAAC;EACL;EAEA6B,YAAYA,CAAA,EAAG;IACX,IAAI,CAACG,YAAY,CAAC,IAAI,CAAC5C,SAAS,EAAE,GAAG,CAAC;IACtC,IAAI,CAAC4C,YAAY,CAAC,IAAI,CAAC3C,YAAY,EAAE,GAAG,CAAC;IACzC,MAAM4C,KAAK,GAAG,IAAI,CAACC,YAAY,CAAC,CAAC;IACjC,IAAID,KAAK,CAACE,iBAAiB,CAACC,MAAM,GAAG,CAAC,EAAE;MACpC,IAAI,CAAC7C,OAAO,GAAG,IAAI;MACnB0C,KAAK,CAACE,iBAAiB,CAACE,OAAO,CAAEC,GAAG,IAAK,IAAI,CAACC,mBAAmB,CAACD,GAAG,CAAC,CAAC;IAC3E;IACA,IAAI,IAAI,CAAC/C,OAAO,IAAI0C,KAAK,CAACE,iBAAiB,CAACC,MAAM,GAAG,CAAC,EAAE;MACpD,IAAI,CAACI,qBAAqB,CAAC,CAAC;IAChC;IACA,IAAI,CAAClD,WAAW,CAACgB,IAAI,CAAC2B,KAAK,CAAC;IAC5B,OAAOA,KAAK;EAChB;EAEAD,YAAYA,CAACS,KAAK,EAAEC,MAAM,EAAE;IACxB,KAAK,MAAMC,IAAI,IAAIF,KAAK,EAAE;MACtBE,IAAI,CAAC9B,CAAC,IAAI6B,MAAM;MAChB,IAAIC,IAAI,CAAC9B,CAAC,GAAG,IAAI,CAAC9B,MAAM,EAAE;QACtB4D,IAAI,CAAC9B,CAAC,GAAG,IAAI,CAAC9B,MAAM;MACxB;IACJ;EACJ;EAEAmD,YAAYA,CAAA,EAAG;IACX,MAAMU,cAAc,GAAG,EAAE;IACzB,MAAMT,iBAAiB,GAAG,EAAE;IAE5B,IAAI,CAAC/C,SAAS,GAAG,IAAI,CAACA,SAAS,CAACyD,MAAM,CAAEf,IAAI,IAAK;MAC7C,IAAIA,IAAI,CAACjB,CAAC,IAAI,IAAI,CAAC7B,aAAa,EAAE;QAC9B4D,cAAc,CAACtC,IAAI,CAACwB,IAAI,CAAC;QACzB,IAAI,CAACtC,KAAK,IAAIsC,IAAI,CAAChB,KAAK;QACxB,OAAO,KAAK;MAChB;MACA,OAAO,IAAI;IACf,CAAC,CAAC;IAEF,IAAI,CAACzB,YAAY,GAAG,IAAI,CAACA,YAAY,CAACwD,MAAM,CAAEP,GAAG,IAAK;MAClD,IAAIA,GAAG,CAACzB,CAAC,IAAI,IAAI,CAAC7B,aAAa,EAAE;QAC7BmD,iBAAiB,CAAC7B,IAAI,CAACgC,GAAG,CAAC;QAC3B,IAAI,CAAC9C,KAAK,IAAI8C,GAAG,CAACxB,KAAK;QACvB,OAAO,KAAK;MAChB;MACA,OAAO,IAAI;IACf,CAAC,CAAC;IAEF,OAAO;MACH8B,cAAc;MACdT;IACJ,CAAC;EACL;EAEApC,SAASA,CAAA,EAAG;IACR,IAAI,CAACG,QAAQ,CAAC,CAAC;IACf,IAAI,CAACR,YAAY,GAAGoD,WAAW,CAAC,MAAM;MAClC,IAAI,CAAC,IAAI,CAACrD,SAAS,EAAE;QACjB,IAAI,CAACS,QAAQ,CAAC,CAAC;QACf;MACJ;MAEA,IAAI,CAAC2B,YAAY,CAAC,CAAC;IACvB,CAAC,EAAE,IAAI,CAAClC,UAAU,CAAC;EACvB;EAEAO,QAAQA,CAAA,EAAG;IACP,IAAI,IAAI,CAACR,YAAY,EAAE;MACnBqD,aAAa,CAAC,IAAI,CAACrD,YAAY,CAAC;MAChC,IAAI,CAACA,YAAY,GAAG,IAAI;IAC5B;EACJ;EAEAsD,OAAOA,CAAA,EAAG;IACN,MAAMC,UAAU,GAAG,IAAI,CAAChD,QAAQ,CAAC,CAAC;IAClC,IAAI,IAAI,CAACV,OAAO,EAAE;MACd,IAAI,CAAC2D,cAAc,CAAC,CAAC;IACzB;IACA,OAAOD,UAAU;EACrB;EAEAjD,QAAQA,CAAA,EAAG;IACP,OAAO;MACHI,KAAK,EAAE,IAAI,CAAChB,SAAS,CAAC+D,GAAG,CAAErB,IAAI,KAAM;QAAE,GAAGA;MAAK,CAAC,CAAC,CAAC;MAClDsB,QAAQ,EAAE,IAAI,CAAC/D,YAAY,CAAC8D,GAAG,CAAEb,GAAG,KAAM;QAAE,GAAGA;MAAI,CAAC,CAAC,CAAC;MACtD9C,KAAK,EAAE,IAAI,CAACA,KAAK;MACjBD,OAAO,EAAE,IAAI,CAACA,OAAO;MACrBE,SAAS,EAAE,IAAI,CAACA,SAAS;MACzBwC,KAAK,EAAE,IAAI,CAAC3C,WAAW,CAACqC,KAAK,CAAC,CAAC,CAAC;IACpC,CAAC;EACL;EAEA0B,OAAOA,CAAA,EAAG;IACN,IAAI,CAACnD,QAAQ,CAAC,CAAC;EACnB;;EAEA;EACA0B,eAAeA,CAACE,IAAI,EAAE;IAClB,OAAOA,IAAI;EACf;EAEAS,mBAAmBA,CAACD,GAAG,EAAE;IACrB,OAAOA,GAAG;EACd;EAEAE,qBAAqBA,CAAA,EAAG;IACpB,IAAI,CAACjD,OAAO,GAAG,KAAK;EACxB;EAEA2D,cAAcA,CAAA,EAAG;IACb,OAAO;MACH1D,KAAK,EAAE,IAAI,CAACA,KAAK;MACjB8D,iBAAiB,EAAE,IAAI,CAACjE,YAAY,CAAC+C;IACzC,CAAC;EACL;AACJ;AAEAmB,MAAM,CAACC,OAAO,GAAG7E,qBAAqB","ignoreList":[]}
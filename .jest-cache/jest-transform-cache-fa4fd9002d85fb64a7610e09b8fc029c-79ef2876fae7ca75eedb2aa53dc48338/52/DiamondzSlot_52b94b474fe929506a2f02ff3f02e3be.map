{"version":3,"names":["SYMBOLS","DiamondzSlot","constructor","options","spinCost","normalizeNumber","credits","startingCredits","resetState","initialize","getState","startGame","generateReels","reels","i","push","slice","spin","isSpinning","success","message","lastSpinResult","map","symbols","Math","floor","random","length","evaluateSpin","result","winAmount","state","every","symbol","Set","size","filter","value","fallback","Number","isNaN","module","exports"],"sources":["DiamondzSlot.js"],"sourcesContent":["'use strict';\n\n/**\n * Game: Diamondz Slot Machine\n * Classic slot machine - spin reels, match diamonds, win jackpot.\n */\n\nconst SYMBOLS = ['DIAMOND', 'CHERRY', 'BELL', 'LEMON', 'SEVEN', 'BAR'];\n\nclass DiamondzSlot {\n\tconstructor(options = {}) {\n\t\tthis.spinCost = this.normalizeNumber(options.spinCost, 5);\n\t\tthis.credits = this.normalizeNumber(options.startingCredits, 100);\n\t\tthis.resetState();\n\t}\n\n\tinitialize(options = {}) {\n\t\tif (typeof options.startingCredits === 'number') {\n\t\t\tthis.credits = this.normalizeNumber(options.startingCredits, this.credits);\n\t\t}\n\t\tif (typeof options.spinCost === 'number') {\n\t\t\tthis.spinCost = this.normalizeNumber(options.spinCost, this.spinCost);\n\t\t}\n\t\tthis.resetState();\n\t\treturn this.getState();\n\t}\n\n\tstartGame() {\n\t\tthis.resetState();\n\t\treturn this.getState();\n\t}\n\n\tgenerateReels() {\n\t\tconst reels = [];\n\t\tfor (let i = 0; i < 3; i += 1) {\n\t\t\treels.push(SYMBOLS.slice());\n\t\t}\n\t\treturn reels;\n\t}\n\n\tspin() {\n\t\tif (this.isSpinning) {\n\t\t\treturn { success: false, message: 'Unable to spin right now.' };\n\t\t}\n\t\tif (this.credits < this.spinCost) {\n\t\t\treturn { success: false, message: 'Not enough credits.' };\n\t\t}\n\n\t\tthis.isSpinning = true;\n\t\tthis.credits -= this.spinCost;\n\n\t\tthis.lastSpinResult = this.reels.map((symbols) => symbols[Math.floor(Math.random() * symbols.length)]);\n\t\tthis.evaluateSpin();\n\t\tthis.isSpinning = false;\n\n\t\treturn {\n\t\t\tsuccess: true,\n\t\t\tresult: this.lastSpinResult.slice(),\n\t\t\tcredits: this.credits,\n\t\t\twinAmount: this.winAmount,\n\t\t\tstate: this.getState()\n\t\t};\n\t}\n\n\tevaluateSpin() {\n\t\tif (this.lastSpinResult.length === 0) {\n\t\t\tthis.winAmount = 0;\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.lastSpinResult.every((symbol) => symbol === 'DIAMOND')) {\n\t\t\tthis.winAmount = 520;\n\t\t\tthis.credits += this.winAmount;\n\t\t\treturn;\n\t\t}\n\n\t\tif (new Set(this.lastSpinResult).size === 1) {\n\t\t\tthis.winAmount = 110;\n\t\t\tthis.credits += this.winAmount;\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.lastSpinResult.filter((symbol) => symbol === 'DIAMOND').length === 2) {\n\t\t\tthis.winAmount = 45;\n\t\t\tthis.credits += this.winAmount;\n\t\t\treturn;\n\t\t}\n\n\t\tthis.winAmount = 0;\n\t}\n\n\tgetState() {\n\t\treturn {\n\t\t\tcredits: this.credits,\n\t\t\tlastSpinResult: this.lastSpinResult.slice(),\n\t\t\twinAmount: this.winAmount,\n\t\t\tspinCost: this.spinCost\n\t\t};\n\t}\n\n\tresetState() {\n\t\tthis.reels = this.generateReels();\n\t\tthis.isSpinning = false;\n\t\tthis.lastSpinResult = [];\n\t\tthis.winAmount = 0;\n\t}\n\n\tnormalizeNumber(value, fallback) {\n\t\tif (typeof value !== 'number' || Number.isNaN(value) || value <= 0) {\n\t\t\treturn fallback;\n\t\t}\n\t\treturn Math.floor(value);\n\t}\n}\n\nmodule.exports = DiamondzSlot;\n"],"mappings":"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","ignoreList":[]}